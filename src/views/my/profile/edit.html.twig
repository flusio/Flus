{% extends 'layouts/modal.html.twig' %}

{% block title %}{{ t('Profile') }}{% endblock %}

{% block body %}
    <div class="wrapper wrapper--small wrapper--center flow flow--large">
        <form
            method="post"
            action="{{ url('update avatar') }}"
            class="flow text--center"
            data-controller="autosubmit form-file"
            enctype="multipart/form-data"
        >
            <img class="avatar avatar--max" src="{{ url_avatar(app.user.avatar_filename) }}" alt="">

            {{ include('alerts/_error.html.twig', { message: form_avatar.error('@base') }) }}

            {% if form_avatar.isInvalid('avatar') %}
                <p id="avatar-error" class="form-group__error text--center">
                    {{ t('Error:') }}
                    {{ form_avatar.error('avatar') }}
                </p>
            {% endif %}

            <input
                type="file"
                name="avatar"
                id="avatar"
                class="form-avatar__input"
                accept="{{ form_avatar.imageAcceptedMimetypes }}"
                data-action="autosubmit#submit"
                data-form-file-target="file"
                hidden
            >

            <div class="text--center">
                <button
                    type="button"
                    data-action="form-file#openFile"
                    data-autosubmit-target="actionButton"
                    aria-describedby="avatar-caption"
                >
                    {{ t('Upload a photo') }}
                </button>
            </div>

            <p id="avatar-caption" class="form-group__caption text--centered">
                {{ t('<abbr>PNG</abbr> or <abbr>JPG</abbr> images only, a 150x150 image is recommended.') | raw }}
            </p>

            <input type="hidden" name="csrf_token" value="{{ csrf_token(form_avatar) }}">
        </form>

        <form method="post" action="{{ url('update profile') }}" class="flow">
            {{ include('alerts/_error.html.twig', { message: form_profile.error('@base') }) }}

            <div class="form-group">
                <label for="username">
                    {{ t('Your name') }}
                    <span class="label__help">
                        {{ t('(public, max. %d characters)', [form_profile.username_max_length]) }}
                    </span>
                </label>

                {% if form_profile.isInvalid('username') %}
                    <p id="username-error" class="form-group__error">
                        {{ t('Error:') }}
                        {{ form_profile.error('username') }}
                    </p>
                {% endif %}

                <input
                    type="text"
                    name="username"
                    id="username"
                    value="{{ form_profile.username }}"
                    maxlength="{{ form_profile.username_max_length }}"
                    required
                    autocomplete="nickname"
                    {% if form_profile.isInvalid('username') %}
                        aria-errormessage="username-error"
                        aria-invalid="true"
                    {% endif %}
                >
            </div>

            <div class="text--center">
                <button type="submit" class="button--primary button--big">
                    {{ t('Save changes') }}
                </button>
            </div>

            <input type="hidden" name="csrf_token" value="{{ csrf_token(form_profile) }}">
        </form>
    </div>
{% endblock %}
